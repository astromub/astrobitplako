<div class="content-section" id="analytics-section">
    <h2>Advanced Analytics</h2>
    <div class="dashboard-grid">
        <div class="stat-cards">
            <div class="stat-card">
                <div class="stat-value" id="total-trades">156</div>
                <div class="stat-label">Total Trades</div>
                <div class="stat-change positive">+24 This Week</div>
            </div>
            <div class="stat-card">
                <div class="stat-value" id="avg-win">$84.50</div>
                <div class="stat-label">Average Win</div>
                <div class="stat-change positive">+$12.30</div>
            </div>
            <div class="stat-card">
                <div class="stat-value" id="avg-loss">$62.80</div>
                <div class="stat-label">Average Loss</div>
                <div class="stat-change negative">-$5.20</div>
            </div>
            <div class="stat-card">
                <div class="stat-value" id="profit-factor">1.42</div>
                <div class="stat-label">Profit Factor</div>
                <div class="stat-change positive">+0.15</div>
            </div>
        </div>
        
        <div class="trading-panel">
            <h3>Performance Over Time</h3>
            <div class="chart-container">
                <canvas id="equity-chart"></canvas>
            </div>
        </div>
        
        <div class="quick-stats">
            <h3>Asset Performance</h3>
            <div class="chart-container">
                <canvas id="asset-performance-chart"></canvas>
            </div>
        </div>
        
        <div class="market-overview">
            <h3>Trade Distribution</h3>
            <div class="chart-container">
                <canvas id="trade-distribution-chart"></canvas>
            </div>
        </div>
        
        <div class="positions-panel">
            <h3>Monthly Performance</h3>
            <table class="positions-table">
                <thead>
                    <tr>
                        <th>Month</th>
                        <th>Trades</th>
                        <th>Win Rate</th>
                        <th>Profit/Loss</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td>January</td>
                        <td>42</td>
                        <td class="positive">71%</td>
                        <td class="positive">+$1,240</td>
                    </tr>
                    <tr>
                        <td>February</td>
                        <td>38</td>
                        <td class="positive">68%</td>
                        <td class="positive">+$980</td>
                    </tr>
                    <tr>
                        <td>March</td>
                        <td>45</td>
                        <td class="positive">74%</td>
                        <td class="positive">+$1,520</td>
                    </tr>
                    <tr>
                        <td>April</td>
                        <td>31</td>
                        <td class="negative">52%</td>
                        <td class="negative">-$320</td>
                    </tr>
                    <tr>
                        <td>May</td>
                        <td>28</td>
                        <td class="positive">67%</td>
                        <td class="positive">+$890</td>
                    </tr>
                </tbody>
            </table>
        </div>

        <div class="trading-panel">
            <h3>Risk Analysis</h3>
            <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px; margin-top: 20px;">
                <div>
                    <h4>Drawdown Analysis</h4>
                    <div class="stat-card" style="margin-top: 15px;">
                        <div class="stat-value">8.2%</div>
                        <div class="stat-label">Maximum Drawdown</div>
                    </div>
                    <div class="stat-card" style="margin-top: 15px;">
                        <div class="stat-value">12.4 days</div>
                        <div class="stat-label">Average Recovery Time</div>
                    </div>
                </div>
                <div>
                    <h4>Risk Metrics</h4>
                    <div class="stat-card" style="margin-top: 15px;">
                        <div class="stat-value">1.85</div>
                        <div class="stat-label">Sharpe Ratio</div>
                    </div>
                    <div class="stat-card" style="margin-top: 15px;">
                        <div class="stat-value">2.1%</div>
                        <div class="stat-label">Volatility</div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<script>
document.addEventListener('DOMContentLoaded', function() {
    // Initialize analytics charts when section is loaded
    const initAnalytics = function() {
        setTimeout(() => {
            // Simple chart initialization without external dependencies
            initCharts();
        }, 100);
    };

    const initCharts = function() {
        // Equity curve chart
        const equityCtx = document.getElementById('equity-chart');
        if (equityCtx) {
            // Simple canvas drawing for equity chart
            const ctx = equityCtx.getContext('2d');
            const width = equityCtx.width;
            const height = equityCtx.height;
            
            // Draw a simple line chart
            ctx.beginPath();
            ctx.moveTo(0, height - 50);
            ctx.lineTo(100, height - 100);
            ctx.lineTo(200, height - 80);
            ctx.lineTo(300, height - 120);
            ctx.lineTo(400, height - 60);
            ctx.lineTo(500, height - 30);
            ctx.strokeStyle = '#10b981';
            ctx.lineWidth = 2;
            ctx.stroke();
        }

        // Asset performance chart (simple pie chart)
        const assetCtx = document.getElementById('asset-performance-chart');
        if (assetCtx) {
            const ctx = assetCtx.getContext('2d');
            // Simple pie chart representation
            const colors = ['#3b82f6', '#10b981', '#f59e0b', '#8b5cf6'];
            const data = [45, 25, 20, 10];
            
            let startAngle = 0;
            for (let i = 0; i < data.length; i++) {
                const sliceAngle = (data[i] / 100) * 2 * Math.PI;
                ctx.beginPath();
                ctx.arc(150, 75, 50, startAngle, startAngle + sliceAngle);
                ctx.lineTo(150, 75);
                ctx.fillStyle = colors[i];
                ctx.fill();
                startAngle += sliceAngle;
            }
        }

        // Trade distribution chart
        const tradeCtx = document.getElementById('trade-distribution-chart');
        if (tradeCtx) {
            const ctx = tradeCtx.getContext('2d');
            // Simple bar chart
            ctx.fillStyle = '#10b981';
            ctx.fillRect(50, 100, 80, -60); // Winning trades
            
            ctx.fillStyle = '#ef4444';
            ctx.fillRect(150, 100, 80, -28); // Losing trades
        }
    };

    // Initialize when section becomes visible
    const observer = new MutationObserver(function(mutations) {
        mutations.forEach(function(mutation) {
            if (mutation.type === 'attributes' && mutation.attributeName === 'style') {
                const analyticsSection = document.getElementById('analytics-section');
                if (analyticsSection && analyticsSection.style.display !== 'none') {
                    initAnalytics();
                }
            }
        });
    });

    const analyticsSection = document.getElementById('analytics-section');
    if (analyticsSection) {
        observer.observe(analyticsSection, { attributes: true });
        
        // Initial check
        if (analyticsSection.style.display !== 'none') {
            initAnalytics();
        }
    }
});
</script>
